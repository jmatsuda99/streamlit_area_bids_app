# エリア別入札データ 可視化ダッシュボード（Streamlit）

Excelの各地域シート（例: 北海道/東北/東京/中部/北陸/関西/中国/四国/九州）を取り込み、内部DB（SQLite）に保存して、
地域・期間・指標を柔軟に切り替えながら見える化できます。GitHub + Streamlit Community Cloud で動作します。

## 機能
- Excelの**複数シートを一括取り込み**（シート名を地域列として付与可）
- 内部DB（SQLite, `data.db`）に**永続保存**
- **列の役割（日時/地域/数値）をUIで指定**できる柔軟設計
- フィルタ：**地域の複数選択**, **期間スライダー**, **粒度（⽇/週/月）**, **集計方法（平均/合計/中央値）**
- 可視化：**時系列（地域別）**, **地域比較バー**, **分布ヒストグラム**, **ピボット（地域×月）**
- **CSVダウンロード**（フィルタ後データ、月次集計）
- 日本語フォントに **Noto Sans JP** を適用（ブラウザ取得）

## 使い方（ローカル）
```bash
pip install -r requirements.txt
streamlit run app.py
```
起動後、左サイドバーから Excel（.xlsx）をアップロードし、**取り込み/追加**を押してください。

## デプロイ（Streamlit Community Cloud）
1. このリポジトリを GitHub にプッシュ
2. Streamlit Community Cloud で **New app** → リポジトリ/ブランチ/`app.py` を指定してデプロイ
3. アプリ起動後に Excel をアップロードして取り込み

> **メモ**: Community Cloud ではインスタンス再起動でDBが初期化されることがあります。長期保管が必要な場合は、
> 外部DB（例: Cloud SQL, Supabase, DuckDB on S3）への切り替えをご検討ください。

## データの前提
- 各シートの列構成は**同一または近い形**を想定しています。
- シート名が地域名の場合は、オプションで **地域列として付与**されます（既に地域列がある場合は併用/重複注意）。
- **日付列の自動推定**を試みますが、UIから手動で変更できます。

## よくある質問
- **文字化け**: 本アプリではブラウザ側で Noto Sans JP を利用します。表示環境に依存するため、必要に応じて組み込みフォントに変更してください。
- **データ更新**: 新しいExcelをアップロードして「取り込み/追加」で追記されます。既存レコードと重複する場合は、現状は重複排除しません（今後の改善点）。
- **Limit 100 の制限**: 本アプリはDB読み出し時にデフォルトで制限をかけません（全件読み込み）。

## ライセンス
MIT
